<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Life Calendar</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        /* ======= RESET ======= */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        html, body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: #0a0a0f;
            position: fixed;
            inset: 0;
        }

        body {
            font-family: 'Outfit', -apple-system, BlinkMacSystemFont, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ======= BACKGROUND LAYERS ======= */
        .bg-layer {
            position: fixed;
            inset: 0;
            z-index: 0;
        }

        .bg-base { background: var(--bg-gradient); }
        .bg-orbs { background: var(--bg-orbs); }

        .bg-noise {
            opacity: 0.03;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        }

        .bg-grid {
            background-image:
                linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 60px 60px;
            opacity: 0.5;
        }

        /* ======= GLASS CONTAINER ======= */
        .container {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 48px 64px;
            background: rgba(15, 15, 25, 0.6);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 24px;
            box-shadow:
                0 8px 32px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(255, 255, 255, 0.03) inset;
            max-width: 98vw;
            max-height: 96vh;
            overflow: hidden;
        }

        .title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.5);
            letter-spacing: 3px;
            margin-bottom: 40px;
            text-align: center;
            text-transform: uppercase;
        }

        .calendar-grid {
            display: flex;
            flex-direction: column;
            gap: var(--row-gap, 20px);
            width: 100%;
        }

        .month-row {
            display: flex;
            align-items: center;
            gap: var(--label-gap, 28px);
            justify-content: flex-start;
            width: 100%;
        }

        .month-label {
            width: var(--label-width, 100px);
            font-family: 'JetBrains Mono', monospace;
            font-size: var(--label-font, 11px);
            font-weight: 500;
            color: rgba(255, 255, 255, 0.35);
            text-align: right;
            letter-spacing: 1px;
            text-transform: uppercase;
            flex-shrink: 0;
        }

        .days-container {
            display: flex;
            gap: var(--dot-gap, 8px);
            flex-wrap: nowrap;
            align-items: center;
        }

        /* ======= DOT STYLES ======= */
        .dot {
            width: var(--dot-size, 22px);
            height: var(--dot-size, 22px);
            border-radius: var(--dot-radius, 6px);
            position: relative;
            flex-shrink: 0;
            transition: all 0.15s ease;
        }

        .dot.filled {
            background: var(--dot-color);
            box-shadow:
                0 2px 8px rgba(var(--dot-rgb), 0.3),
                0 0 0 1px rgba(255, 255, 255, 0.05) inset;
        }

        .dot.empty {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .dot.today {
            background: var(--today-color);
            box-shadow:
                0 0 20px rgba(var(--today-rgb), 0.5),
                0 0 40px rgba(var(--today-rgb), 0.2),
                0 2px 8px rgba(var(--today-rgb), 0.4);
            transform: scale(1.1);
            border-radius: calc(var(--dot-radius, 6px) + 2px);
        }

        .dot.disabled {
            background: rgba(255, 255, 255, 0.015);
            border: 1px solid rgba(255, 255, 255, 0.02);
            opacity: 0.4;
        }

        /* ======= PROGRESS BAR ======= */
        .progress-wrapper {
            width: 100%;
            margin-top: 32px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }

        .progress-bar {
            width: 100%;
            max-width: 600px;
            height: 8px;
            background: rgba(255, 255, 255, 0.06);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--progress-gradient);
            border-radius: 4px;
            box-shadow: var(--progress-glow);
        }

        .footer {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            font-weight: 400;
            color: rgba(255, 255, 255, 0.3);
            letter-spacing: 2px;
            margin-top: 12px;
            text-align: center;
            text-transform: uppercase;
        }

        .footer span {
            color: var(--accent-color);
            font-weight: 500;
        }

        /* ======= RESPONSIVE: TABLET ======= */
        @media (max-width: 768px) {
            .container {
                padding: 24px 20px;
                border-radius: 16px;
            }
            .title {
                font-size: 11px;
                letter-spacing: 2px;
                margin-bottom: 24px;
            }
            .progress-bar { height: 6px; }
            .footer { font-size: 10px; letter-spacing: 1px; }
            .bg-grid { background-size: 40px 40px; }
        }

        /* ======= RESPONSIVE: MOBILE ======= */
        @media (max-width: 480px) {
            .container {
                padding: 16px 12px;
                border-radius: 12px;
            }
            .title {
                font-size: 9px;
                margin-bottom: 16px;
                letter-spacing: 1.5px;
            }
            .progress-wrapper { margin-top: 20px; gap: 8px; }
            .footer { font-size: 8px; }
        }

        /* ======= RESPONSIVE: SMALL PHONE ======= */
        @media (max-width: 400px) {
            .container {
                padding: 12px 8px;
                border-radius: 10px;
            }
            .title {
                font-size: 8px;
                margin-bottom: 12px;
            }
            .progress-bar { height: 4px; }
        }
    </style>
</head>
<body style="background: #0a0a0f !important;">
    <!-- Layered background -->
    <div class="bg-layer bg-base"></div>
    <div class="bg-layer bg-orbs"></div>
    <div class="bg-layer bg-grid"></div>
    <div class="bg-layer bg-noise"></div>

    <div class="container">
        <h1 class="title" id="title">180 Days</h1>
        <div class="calendar-grid" id="calendarGrid"></div>
        <div class="progress-wrapper">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="footer" id="footer"></div>
        </div>
    </div>

    <script>
        // =========================================================
        // DYNAMIC THEME GENERATOR
        // Uses HSL color theory — unique colors every day.
        // Same algorithm as the Python DailyTheme class.
        // =========================================================

        function generateDailyTheme() {
            // Date-based seed for reproducible daily themes
            const today = new Date();
            const dateStr = today.toISOString().split('T')[0]; // "YYYY-MM-DD"

            // Simple string hash → seed integer
            let seed = 0;
            for (let i = 0; i < dateStr.length; i++) {
                seed = ((seed << 5) - seed + dateStr.charCodeAt(i)) | 0;
            }
            seed = Math.abs(seed);

            // Seeded pseudo-random number generator (Park-Miller LCG)
            function rand() {
                seed = (seed * 16807 + 12345) % 2147483647;
                return (seed & 0x7fffffff) / 2147483647;
            }

            // HSL → RGB (h: 0-360, s: 0-1, l: 0-1) → [r, g, b] (0-255)
            function hslToRgb(h, s, l) {
                h = ((h % 360) + 360) % 360;
                s = Math.max(0, Math.min(1, s));
                l = Math.max(0, Math.min(1, l));
                const c = (1 - Math.abs(2 * l - 1)) * s;
                const x = c * (1 - Math.abs(((h / 60) % 2) - 1));
                const m = l - c / 2;
                let r, g, b;
                if (h < 60)       { r = c; g = x; b = 0; }
                else if (h < 120) { r = x; g = c; b = 0; }
                else if (h < 180) { r = 0; g = c; b = x; }
                else if (h < 240) { r = 0; g = x; b = c; }
                else if (h < 300) { r = x; g = 0; b = c; }
                else              { r = c; g = 0; b = x; }
                return [Math.round((r+m)*255), Math.round((g+m)*255), Math.round((b+m)*255)];
            }

            function rgbHex(r, g, b) {
                return '#' + [r, g, b].map(v => v.toString(16).padStart(2, '0')).join('');
            }

            // ---- Base hue: the "mood" of the day ----
            const baseHue = rand() * 360;

            // ---- Color harmony strategy ----
            const strategies = ['complementary', 'analogous', 'triadic', 'split', 'tetradic'];
            const strategy = strategies[Math.floor(rand() * strategies.length)];

            let accentHues;
            if (strategy === 'complementary') {
                accentHues = [baseHue, (baseHue + 180) % 360];
            } else if (strategy === 'analogous') {
                const off = 25 + rand() * 15;
                accentHues = [baseHue, (baseHue + off) % 360, (baseHue - off + 360) % 360];
            } else if (strategy === 'triadic') {
                accentHues = [baseHue, (baseHue + 120) % 360, (baseHue + 240) % 360];
            } else if (strategy === 'split') {
                accentHues = [baseHue, (baseHue + 150) % 360, (baseHue + 210) % 360];
            } else {
                accentHues = [baseHue, (baseHue + 90) % 360, (baseHue + 180) % 360, (baseHue + 270) % 360];
            }

            // ---- Filled dot colors (bright, saturated) ----
            const filled = [];
            for (let i = 0; i < 4; i++) {
                const hue = accentHues[i % accentHues.length];
                const sat = 0.50 + rand() * 0.30;
                const lit = 0.55 + rand() * 0.20;
                const rgb = hslToRgb(hue, sat, lit);
                filled.push({ hex: rgbHex(...rgb), rgb: rgb.join(', ') });
            }

            // ---- Today color (vibrant accent) ----
            const todayHue = (baseHue + 40 + rand() * 40) % 360;
            const todayRgb = hslToRgb(todayHue, 0.85, 0.70);

            // ---- Background gradient (very dark with subtle color tint) ----
            const bg1 = hslToRgb(baseHue, 0.40, 0.06);
            const bg2 = hslToRgb((baseHue + 15) % 360, 0.35, 0.08);
            const bg3 = hslToRgb((baseHue - 10 + 360) % 360, 0.30, 0.04);

            // ---- Orb colors (soft, atmospheric glow) ----
            const orb1 = hslToRgb(accentHues[0], 0.70, 0.50);
            const orb2 = hslToRgb(accentHues[1 % accentHues.length], 0.60, 0.45);
            const orb3 = hslToRgb(accentHues[Math.min(2, accentHues.length - 1)], 0.55, 0.50);

            return {
                bgGradient: `linear-gradient(135deg, rgb(${bg1}) 0%, rgb(${bg2}) 50%, rgb(${bg3}) 100%)`,
                bgOrbs: `
                    radial-gradient(ellipse 80% 50% at 20% 40%, rgba(${orb1}, 0.15) 0%, transparent 50%),
                    radial-gradient(ellipse 60% 40% at 80% 20%, rgba(${orb2}, 0.12) 0%, transparent 50%),
                    radial-gradient(ellipse 50% 50% at 60% 80%, rgba(${orb3}, 0.08) 0%, transparent 50%)
                `,
                filled: filled,
                today: { hex: rgbHex(...todayRgb), rgb: todayRgb.join(', ') },
                accent: `rgba(${todayRgb.join(',')}, 0.9)`,
                progressGradient: `linear-gradient(90deg, ${filled[0].hex} 0%, ${filled[1].hex} 50%, ${filled[2 % filled.length].hex} 100%)`,
                progressGlow: `0 0 12px rgba(${filled[0].rgb}, 0.4)`
            };
        }

        // =========================================================
        // RESPONSIVE DOT SIZING
        // Adapts to viewport so dots never overflow on mobile.
        // =========================================================

        function computeDotSizing() {
            const vw = window.innerWidth;
            const vh = window.innerHeight;

            // Available width inside container (accounting for padding + labels)
            let containerPad, labelWidth, labelGap, dotGap, rowGap;

            if (vw <= 400) {
                // Small phone
                containerPad = 8 * 2;
                labelWidth = 38;
                labelGap = 6;
                dotGap = 1;
                rowGap = 8;
            } else if (vw <= 480) {
                // Regular phone
                containerPad = 12 * 2;
                labelWidth = 50;
                labelGap = 8;
                dotGap = 2;
                rowGap = 10;
            } else if (vw <= 768) {
                // Tablet
                containerPad = 20 * 2;
                labelWidth = 70;
                labelGap = 16;
                dotGap = 5;
                rowGap = 16;
            } else {
                // Desktop
                containerPad = 64 * 2;
                labelWidth = 100;
                labelGap = 28;
                dotGap = 8;
                rowGap = 20;
            }

            // Width available for 31 dot cells (dot + gap)
            const availableForDots = vw - containerPad - labelWidth - labelGap - 20; // 20px safety
            const cellWidth = availableForDots / 31;
            // Dot size is the cell minus the gap, but ensure minimum
            let dotSize = Math.max(4, Math.floor(cellWidth - dotGap));
            // Cap dot size so desktop doesn't produce huge dots
            dotSize = Math.min(dotSize, 22);
            const dotRadius = Math.max(2, Math.round(dotSize * 0.27));
            const labelFont = Math.max(7, Math.min(11, Math.round(dotSize * 0.55)));

            // Set CSS custom properties
            const root = document.documentElement;
            root.style.setProperty('--dot-size', dotSize + 'px');
            root.style.setProperty('--dot-gap', dotGap + 'px');
            root.style.setProperty('--dot-radius', dotRadius + 'px');
            root.style.setProperty('--label-width', labelWidth + 'px');
            root.style.setProperty('--label-gap', labelGap + 'px');
            root.style.setProperty('--label-font', labelFont + 'px');
            root.style.setProperty('--row-gap', rowGap + 'px');

            return { dotSize, dotGap, labelWidth };
        }

        // =========================================================
        // APPLY THEME + RENDER CALENDAR
        // =========================================================

        // Generate the daily theme
        const theme = generateDailyTheme();

        // Apply theme CSS variables
        document.documentElement.style.setProperty('--bg-gradient', theme.bgGradient);
        document.documentElement.style.setProperty('--bg-orbs', theme.bgOrbs);
        document.documentElement.style.setProperty('--accent-color', theme.accent);
        document.documentElement.style.setProperty('--progress-gradient', theme.progressGradient);
        document.documentElement.style.setProperty('--progress-glow', theme.progressGlow);

        // Ensure dark background immediately
        document.documentElement.style.background = '#0a0a0f';
        document.body.style.background = '#0a0a0f';

        // Compute responsive dot sizes
        computeDotSizing();

        // ---- Calendar config (replaced by API server for custom dates) ----
        const config = {
            yearStart: '2025-12-01',
            yearEnd: '2026-05-31',
            title: '180 DAYS'
        };

        const start = new Date(config.yearStart);
        start.setHours(0, 0, 0, 0);
        const end = new Date(config.yearEnd);
        end.setHours(23, 59, 59, 999);
        const today = new Date();
        today.setHours(0, 0, 0, 0);

        // Build month data
        const months = [];
        let dateIter = new Date(start);
        while (dateIter <= end) {
            const y = dateIter.getFullYear();
            const m = dateIter.getMonth();
            const monthStart = new Date(y, m, 1);
            const monthEnd = new Date(y, m + 1, 0);
            const clampedStart = new Date(Math.max(monthStart, start));
            clampedStart.setHours(0, 0, 0, 0);
            const clampedEnd = new Date(Math.min(monthEnd, end));
            clampedEnd.setHours(23, 59, 59, 999);

            months.push({
                year: y,
                month: m,
                name: monthStart.toLocaleDateString('en-US', { month: 'short', year: 'numeric' }).toUpperCase(),
                days: monthEnd.getDate(),
                start: clampedStart,
                end: clampedEnd
            });
            dateIter = new Date(y, m + 1, 1);
        }

        // Calculate progress
        const totalDays = Math.floor((end - start) / 86400000) + 1;
        const daysElapsed = Math.max(0, Math.min(totalDays, Math.floor((today - start) / 86400000) + 1));
        const daysLeft = totalDays - daysElapsed;
        const percent = Math.round((daysElapsed / totalDays) * 100);

        // Update UI
        document.getElementById('footer').innerHTML =
            `<span>${daysLeft}</span> days left · <span>${percent}%</span> complete`;
        document.getElementById('title').textContent = config.title;
        document.getElementById('progressFill').style.width = `${percent}%`;

        // ---- Render calendar grid ----
        const grid = document.getElementById('calendarGrid');
        months.forEach(month => {
            const row = document.createElement('div');
            row.className = 'month-row';

            const label = document.createElement('div');
            label.className = 'month-label';
            label.textContent = month.name;
            row.appendChild(label);

            const days = document.createElement('div');
            days.className = 'days-container';

            for (let day = 1; day <= 31; day++) {
                const dayDate = new Date(month.year, month.month, day);
                dayDate.setHours(0, 0, 0, 0);

                const dayTime = dayDate.getTime();
                const startTime = month.start.getTime();
                const endTime = month.end.getTime();

                // Disabled: non-existent day or outside range
                if (day > month.days || dayTime < startTime || dayTime > endTime) {
                    const dot = document.createElement('div');
                    dot.className = 'dot disabled';
                    days.appendChild(dot);
                    continue;
                }

                const isFilled = dayDate <= today;
                const isToday = dayDate.getTime() === today.getTime();
                const weekGroup = Math.floor((day - 1) / 7) % 4;

                const dot = document.createElement('div');
                dot.className = `dot ${isFilled ? 'filled' : 'empty'} ${isToday ? 'today' : ''}`;

                if (isFilled && !isToday) {
                    const colorData = theme.filled[weekGroup];
                    dot.style.setProperty('--dot-color', colorData.hex);
                    dot.style.setProperty('--dot-rgb', colorData.rgb);
                }

                if (isToday) {
                    dot.style.setProperty('--today-color', theme.today.hex);
                    dot.style.setProperty('--today-rgb', theme.today.rgb);
                }

                days.appendChild(dot);
            }

            row.appendChild(days);
            grid.appendChild(row);
        });
    </script>
</body>
</html>
